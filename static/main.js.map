{"version":3,"sources":["./src/app/service/websocket/websocket.service.ts","./src/app/component/room/room.viewmodel.ts","./src/environments/environment.ts","./src/app/component/room/room.component.ts","./src/app/component/room/room.component.html","./src/app/app.component.ts","./src/app/app.component.html","./src/app/page/lobby/lobby.component.ts","./src/app/page/lobby/lobby.component.html","./src/app/app.module.ts","./src/app/service/websocket/websocket.schema.ts","./src/app/page/lobby/lobby.viewmodel.ts","./src/app/app-routing.module.ts","./src/main.ts","./$_lazy_route_resource lazy namespace object"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport { DemoMessage } from './websocket.schema';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class WebsocketService {\n\n  // 第三方測試 http://coolaf.com/tool/chattest\n\n  public conn: WebSocket\n  // private host = `ws://123.193.145.165:1002/ws`\n  private host = `ws://${document.location.host}/ws`\n\n  onMessage$ = new Subject<DemoMessage>();\n\n  // ====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====\n\n  constructor() { }\n\n  // ====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====\n  startConnect() {\n    if (window[\"WebSocket\"]) {\n      this.conn = new WebSocket(this.host);\n      this.conn.onclose = function(evt) {\n        console.log('Connection closed.')\n      };\n      this.conn.onmessage = (evt: MessageEvent) => {\n\n        let data: string = evt.data\n        let split = data.split('\\n')\n        for (const subDate of split) {\n          if (subDate && !subDate.includes('wel')) {\n            // 有純的 welecome 訊息\n            let mes = new DemoMessage(subDate)\n            this.onMessage$.next(mes)\n            // console.log(mes)\n          }\n        }\n      };\n    } else {\n      console.log('Your browser does not support WebSockets.')\n    }\n  }\n\n  sendBet(room_id: string, area: number, amount: number) {\n    let dict = {\n      cmd: 'bet',\n      value: {\n        room_id,\n        area,\n        amount,\n      }\n    }\n    this.conn.send(JSON.stringify(dict))\n  }\n}\n","import { ActionDisplayName, DemoRoomAction } from \"src/app/service/websocket/websocket.schema\"\n\nexport class RoomViewModel {\n\n  name = ''\n  action = DemoRoomAction.init\n  targetTime = new Date()\n  remaindTime = ''\n  updateRemaindTime() {\n    let ms = this.targetTime.getTime() - new Date().getTime();\n    let s = Math.floor(Math.max(0, ms / 1000))\n    this.remaindTime = s.toString();\n  }\n\n  get actionName() {\n    return ActionDisplayName[this.action]\n  }\n\n  betAreaList: BetAreaViewModel[] = AllBetAreaId.map(id => new BetAreaViewModel(id))\n}\n\nconst AllBetAreaId = [1, 2]\nexport class BetAreaViewModel {\n\n  point = 0\n  amount = 0\n  isWin = false\n\n  constructor(\n    public id: number\n  ) { }\n\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { Component, EventEmitter, Input, OnDestroy, OnInit, Output } from '@angular/core';\nimport { interval, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { BetAreaViewModel, RoomViewModel } from './room.viewmodel';\n\n@Component({\n  selector: 'app-room',\n  templateUrl: './room.component.html',\n  styleUrls: ['./room.component.scss']\n})\nexport class RoomComponent implements OnInit, OnDestroy {\n\n  @Input()\n  viewModel: RoomViewModel\n\n  @Output()\n  areaClick = new EventEmitter<BetAreaViewModel>()\n\n  private ngUnsubscribe = new Subject<void>();\n\n  // ====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====\n\n  constructor() { }\n\n  ngOnInit(): void {\n    const source = interval(300);\n    source.pipe(\n      takeUntil(this.ngUnsubscribe)\n    )\n    .subscribe(() => {\n      this.viewModel.updateRemaindTime();\n    });\n  }\n\n  ngOnDestroy(): void {\n    this.ngUnsubscribe.next();\n    this.ngUnsubscribe.complete();\n  }\n\n  // ====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====\n\n}\n","\n<ng-container *ngIf=\"viewModel\">\n\n  <label>房名: {{ viewModel.name }}</label>&nbsp;\n  <label>動作: {{ viewModel.actionName }}</label><br>\n  <label>倒數: {{ viewModel.remaindTime }}秒</label><br>\n\n  <ng-container *ngFor=\"let betArea of viewModel.betAreaList\">\n\n    <div class=\"bet-area\" (click)=\"areaClick.emit(betArea)\">\n      <label>下注區:{{ betArea.id }}</label><br>\n      <label>壓注:{{ betArea.amount }}</label><br>\n      <label *ngIf=\"betArea.point !== 0\">點數:{{ betArea.point }}</label><br>\n      <label *ngIf=\"betArea.isWin\">WIN</label>\n      <label *ngIf=\"!betArea.isWin\">_</label>\n    </div>\n\n  </ng-container>\n  <hr>\n</ng-container>\n\n","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent {\n\n  constructor() {\n\n  }\n\n}\n","\n<router-outlet></router-outlet>\n","import { Component, OnInit } from '@angular/core';\nimport { DemoCmd, DemoRoomAction } from 'src/app/service/websocket/websocket.schema';\nimport { WebsocketService } from 'src/app/service/websocket/websocket.service';\nimport { LobbyViewModel } from './lobby.viewmodel';\nimport { BetAreaViewModel, RoomViewModel } from '../../component/room/room.viewmodel';\n\n@Component({\n  selector: 'app-lobby',\n  templateUrl: './lobby.component.html',\n  styleUrls: ['./lobby.component.scss']\n})\nexport class LobbyComponent implements OnInit {\n\n  viewModel = new LobbyViewModel()\n\n  // ====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====\n\n  constructor(\n    private websocket: WebsocketService,\n  ) { }\n\n  ngOnInit(): void {\n  }\n\n  // ====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====\n  startConnect() {\n    if (!this.websocket.conn) {\n      this.websocket.startConnect()\n      this.websocket.onMessage$.subscribe((event) => {\n        if (event.cmd === DemoCmd.game_player_info) {\n          console.log(`使用者:${event.user_name},餘額:${event.balance}`)\n          this.viewModel.userName = event.user_name\n          this.viewModel.balance = event.balance\n        }\n        else if (event.cmd === DemoCmd.game_state) {\n          console.log(`房間:${event.room_name},動作:${event.action},資料:${JSON.stringify(event.data)}`)\n\n          // 檢查並建立房間\n          {\n            let room = this.viewModel.roomList.find(ele => ele.name === event.room_name)\n            if (!room) {\n              let newRoom = new RoomViewModel()\n              newRoom.name = event.room_name\n              this.viewModel.roomList.push(newRoom)\n            }\n          }\n          {\n            let room = this.viewModel.roomList.find(ele => ele.name === event.room_name)\n            if (room) {\n              room.action = event.action\n              if (event.data && event.data.seconds) {\n                room.targetTime = new Date(new Date().getTime() + event.data.seconds * 1000);\n              }\n              if (event.action === DemoRoomAction.start_bet) {\n                for (const betArea of room.betAreaList) {\n                  betArea.point = 0\n                  betArea.amount = 0\n                  betArea.isWin = false\n                }\n              }\n              else if (event.action === DemoRoomAction.result) {\n                let pointDict = event.data.point\n                for (const idStr in pointDict) {\n                  const point = pointDict[idStr];\n                  let id = parseInt(idStr)\n                  let betArea = room.betAreaList.find(ele => ele.id === id)\n                  if (betArea) {\n                    betArea.point = point\n                  }\n                }\n                let win_area = event.data.win_area\n                for (const betArea of room.betAreaList) {\n                  betArea.isWin = (betArea.id === win_area)\n                }\n              }\n            }\n          }\n        }\n        else if (event.cmd === DemoCmd.bet) {\n          if (event.error_message) {\n            console.log(event.error_message)\n            return\n          }\n          console.log(`下注資料:${JSON.stringify(event.obj, null, 2)}`)\n          this.viewModel.balance = event.balance\n          let bet_info = event.bet_info\n          let room = this.viewModel.roomList.find(ele => ele.name === bet_info.room_id)\n          if (room) {\n            let betArea = room.betAreaList.find(ele => ele.id === bet_info.area)\n            if (betArea) {\n              betArea.amount = parseInt(bet_info.amount)\n            }\n          }\n        }\n        else if (event.cmd === DemoCmd.game_result) {\n          console.log(`結算資料:${JSON.stringify(event.obj, null, 2)}`)\n          this.viewModel.balance = event.balance\n        }\n        else {\n          console.log(event.cmd, event.obj)\n        }\n      })\n    }\n    else {\n      console.log('連線已存在')\n    }\n  }\n\n  areaClick(room: RoomViewModel, betArea: BetAreaViewModel) {\n    // console.log(room, betArea)\n    this.websocket.sendBet(room.name, betArea.id, this.viewModel.selectPoint)\n  }\n}\n","\n<ng-container *ngIf=\"!viewModel.userName\">\n  <button (click)=\"startConnect()\">連線</button>\n</ng-container>\n\n<ng-container *ngIf=\"viewModel.userName\">\n\n  <label>使用者:{{ viewModel.userName }}</label><br>\n  <label>餘額:{{ viewModel.balance }}</label>\n\n  <ng-container *ngFor=\"let point of viewModel.optionalPoint\">\n    <button (click)=\"viewModel.selectPoint = point\">\n      <label *ngIf=\"viewModel.selectPoint === point\">*</label>\n      {{point}}\n    </button>\n  </ng-container>\n\n</ng-container>\n\n<hr>\n\n<ng-container *ngFor=\"let room of viewModel.roomList\">\n\n  <app-room\n    [viewModel]='room'\n    (areaClick)=\"areaClick(room, $event)\"\n  ></app-room>\n\n</ng-container>\n","import { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { LobbyComponent } from './page/lobby/lobby.component';\nimport { WebsocketService } from './service/websocket/websocket.service';\nimport { RoomComponent } from './component/room/room.component';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    LobbyComponent,\n    RoomComponent\n  ],\n  imports: [\n    BrowserModule,\n    AppRoutingModule\n  ],\n  providers: [\n    WebsocketService,\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","\nexport enum DemoCmd {\n  game_player_info = 'game_player_info',\n  game_state = 'game_state',\n  bet = 'bet',\n  game_result = 'game_result',\n}\n\nexport enum DemoRoomAction {\n  init = 'init',\n  start_bet = 'start_bet',\n  count_down = 'count_down',\n  stop_bet = 'stop_bet',\n  result = 'result',\n}\n\nexport const ActionDisplayName = {\n  [DemoRoomAction.init]: '初始化',\n  [DemoRoomAction.start_bet]: '下注中',\n  [DemoRoomAction.count_down]: '下注中',\n  [DemoRoomAction.stop_bet]: '結束下注',\n  [DemoRoomAction.result]: '結算中',\n}\n\nexport class DemoMessage {\n\n  obj: any = {}\n\n  // ====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====\n\n  constructor(public str: string) {\n    try {\n      this.obj = JSON.parse(str)\n    } catch (error) {\n      console.log(`DemoMessage parse <${str}> error: error`)\n    }\n  }\n\n  // ====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====\n  // present\n\n  // 通用\n  get cmd(): DemoCmd | undefined {\n    return this.obj.cmd\n  }\n\n  // 使用者\n  get user_name(): string | undefined {\n    return this.obj.user_name\n  }\n\n  get balance(): string | undefined {\n    return this.obj.balance\n  }\n\n  // 房間\n  get room_name(): string | undefined {\n    return this.obj.room_name\n  }\n\n  get action(): DemoRoomAction | undefined {\n    return this.obj.action\n  }\n\n  get data(): any {\n    return this.obj.data\n  }\n\n  // 下注\n  get bet_info(): any {\n    return this.obj.bet_info\n  }\n\n  get error_message(): string {\n    return this.obj.error_message\n  }\n\n  // ====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====.====\n}\n","import { RoomViewModel } from \"src/app/component/room/room.viewmodel\";\n\nexport class LobbyViewModel {\n\n  userName = ''\n  balance = ''\n\n  selectPoint = 50\n  optionalPoint = [50, 100, 150, 200]\n\n  roomList: RoomViewModel[] = []\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { LobbyComponent } from './page/lobby/lobby.component';\n\nconst routes: Routes = [\n  { path: '', component: LobbyComponent },\n];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"],"sourceRoot":"webpack:///"}